<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TravelVax - Vaccine Recommendations for Travelers</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #4285f4, #34a853);
            --secondary-gradient: linear-gradient(135deg, #fbbc05, #ea4335);
            --accent-gradient: linear-gradient(135deg, #34a853, #4285f4);
            --light-gradient: linear-gradient(135deg, #f8f9fa, #e9ecef);
            --dark-gradient: linear-gradient(135deg, #212529, #343a40);
            --primary-color: #4285f4;
            --secondary-color: #34a853;
            --accent-color: #fbbc05;
            --danger-color: #ea4335;
            --light-bg: #f8f9fa;
            --dark-bg: #212529;
            --text-color: #333;
            --light-text: #f8f9fa;
            --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --hover-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            --transition-speed: 0.3s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--light-gradient);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 0%, transparent 50%);
            opacity: 0.6;
        }

        .header-content {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 2rem;
            width: 100%;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            font-size: 2rem;
            margin: 0;
            animation: pulse 2s ease-in-out infinite;
        }

        .logo h1 {
            font-size: 1.8rem;
            margin: 0;
            background: linear-gradient(135deg, #ffffff, #e0e0e0);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .header-text {
            text-align: center;
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.4;
        }

        .header-stats {
            display: flex;
            gap: 1rem;
            margin: 0;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s, background 0.3s;
            text-align: center;
        }

        .stat-number {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
            margin: 0;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @media (max-width: 768px) {
            .header-content {
                grid-template-columns: 1fr;
                gap: 1rem;
                text-align: center;
            }

            .logo {
                justify-content: center;
            }

            .header-stats {
                justify-content: center;
                flex-wrap: wrap;
            }

            .stat-item {
                flex: 1 1 auto;
                min-width: 100px;
            }
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        .search-container {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            margin-bottom: 2rem;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }

        .search-container:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }

        .search-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .search-header h2 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }

        .search-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-color);
        }

        select {
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            background-color: white;
            font-size: 1rem;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
            cursor: pointer;
        }

        input[type="number"] {
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            background-color: white;
            font-size: 1rem;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
        }

        .results-container {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            display: none;
            transition: transform var(--transition-speed);
        }

        .country-info {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #e9ecef;
        }

        .country-flag {
            width: 80px;
            height: 60px;
            object-fit: cover;
            margin-right: 1.5rem;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            transition: transform var(--transition-speed);
        }

        .country-flag:hover {
            transform: scale(1.05);
        }

        .vaccine-item {
            background: var(--light-gradient);
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }

        .vaccine-item:hover {
            transform: translateX(5px);
            box-shadow: var(--hover-shadow);
        }

        .vaccine-name {
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
        }

        .tabs {
            display: flex;
            margin: 2rem 0;
            border-bottom: 2px solid #e9ecef;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 1rem 2rem;
            cursor: pointer;
            background: var(--light-gradient);
            border: none;
            border-radius: 10px;
            transition: all var(--transition-speed);
            font-weight: 500;
        }

        .tab.active {
            background: var(--primary-gradient);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--card-shadow);
        }

        .tab-content {
            display: none;
            padding: 2rem;
            border-radius: 10px;
            background: white;
            box-shadow: var(--card-shadow);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem auto;
            text-align: center;
            position: relative;
            width: 280px;
            height: 280px;
            background: transparent;
            border-radius: 20px;
            box-shadow: none;
            overflow: hidden;
            flex-direction: column;
        }

        .loader-scene {
            position: relative;
            width: 100%;
            height: 100%;
            perspective: 1000px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .doctor, .patient, .syringe, .medicine, .heart, .sparkle {
            position: absolute;
            font-size: 30px;
            animation: float 1.5s ease-in-out infinite;
        }

        .loading-stage {
            display: none;
        }

        .loading-stage::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 200%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent
            );
            animation: stageScan 2s linear infinite;
        }

        .loader-text {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1rem;
            color: #666;
            background: transparent;
            animation: textMove 1.5s infinite;
            margin-top: 10px;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            20% {
                transform: translateY(-20px);
            }
            50% {
                transform: translateY(-40px);
            }
            80% {
                transform: translateY(-20px);
            }
        }

        @keyframes stageScan {
            0% { transform: translateX(0); }
            50% { transform: translateX(50%); }
            100% { transform: translateX(100%); }
        }

        @keyframes textMove {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(15px);
            }
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .vaccine-loader {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            animation: rotate 15s linear infinite;
        }

        .syringe-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-style: preserve-3d;
            transform: translate(-50%, -50%) rotateX(20deg);
            animation: float 4s ease-in-out infinite;
        }

        .syringe {
            position: relative;
            width: 60px;
            height: 120px;
            transform-style: preserve-3d;
        }

        .syringe-body {
            position: absolute;
            width: 20px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transform-style: preserve-3d;
        }

        .syringe-body::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, rgba(255,255,255,0.1), rgba(255,255,255,0.3));
            border-radius: 10px;
            transform: translateZ(1px);
        }

        .syringe-needle {
            position: absolute;
            width: 4px;
            height: 30px;
            background: linear-gradient(to bottom, #666, #999);
            top: -30px;
            left: 50%;
            transform: translateX(-50%) translateZ(2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .syringe-needle::before {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: #666;
            border-radius: 50%;
            top: -3px;
            left: 50%;
            transform: translateX(-50%);
        }

        .syringe-plunger {
            position: absolute;
            width: 24px;
            height: 20px;
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            border-radius: 10px;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateZ(1px);
            animation: push 2s ease-in-out infinite;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .liquid {
            position: absolute;
            width: 16px;
            height: 0;
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            border-radius: 8px;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateZ(0.5px);
            animation: fill 2s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .injection-site {
            position: absolute;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at center, #f8f9fa, #e9ecef);
            border-radius: 50%;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%) translateZ(-10px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            animation: pulse 2s ease-in-out infinite;
        }

        .injection-site::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(52, 168, 83, 0.2), transparent);
            border-radius: 50%;
            animation: ripple 2s ease-in-out infinite;
        }

        .bubbles {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        .bubble {
            position: absolute;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9), rgba(255,255,255,0.4));
            border-radius: 50%;
            animation: rise 2s ease-in-out infinite;
            box-shadow: 0 2px 4px rgba(255,255,255,0.3);
            transform-style: preserve-3d;
        }

        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--primary-color);
            border-radius: 50%;
            animation: particleFloat 3s ease-in-out infinite;
            opacity: 0.6;
            transform-style: preserve-3d;
        }

        @keyframes push {
            0%, 100% {
                transform: translateX(-50%) translateZ(1px) translateY(0);
            }
            50% {
                transform: translateX(-50%) translateZ(1px) translateY(-20px);
            }
        }

        @keyframes fill {
            0%, 100% {
                height: 0;
                opacity: 0.8;
            }
            50% {
                height: 60px;
                opacity: 1;
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: translate(-50%, -50%) translateZ(-10px) scale(1);
            }
            50% {
                transform: translate(-50%, -50%) translateZ(-10px) scale(1.1);
            }
        }

        @keyframes ripple {
            0% {
                transform: scale(0.5);
                opacity: 0.5;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        @keyframes rise {
            0% {
                bottom: -30px;
                opacity: 0;
                transform: scale(0.5) translateZ(0);
            }
            20% {
                opacity: 0.5;
                transform: scale(0.75) translateZ(10px);
            }
            50% {
                opacity: 1;
                transform: scale(1) translateZ(20px);
            }
            80% {
                opacity: 0.5;
                transform: scale(0.75) translateZ(10px);
            }
            100% {
                bottom: 100%;
                opacity: 0;
                transform: scale(0.5) translateZ(0);
            }
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translate(0, 0) scale(1) translateZ(0);
                opacity: 0.6;
            }
            20% {
                transform: translate(15px, -15px) scale(1.2) translateZ(10px);
                opacity: 0.4;
            }
            50% {
                transform: translate(30px, -30px) scale(1.5) translateZ(20px);
                opacity: 0.3;
            }
            80% {
                transform: translate(15px, -15px) scale(1.2) translateZ(10px);
                opacity: 0.4;
            }
        }

        .alert {
            padding: 1.25rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            font-weight: 500;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .alert-info {
            background: linear-gradient(135deg, rgba(66, 133, 244, 0.1), rgba(52, 168, 83, 0.1));
            border-left: 4px solid var(--primary-color);
            color: var(--primary-color);
        }

        .alert-warning {
            background: linear-gradient(135deg, rgba(251, 188, 5, 0.1), rgba(234, 67, 53, 0.1));
            border-left: 4px solid var(--accent-color);
            color: #d18700;
        }

        footer {
            background: var(--dark-gradient);
            color: var(--light-text);
            padding: 3rem 0;
            margin-top: 4rem;
            text-align: center;
            font-size: 0.9rem;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
                margin: 1rem auto;
            }

            .search-container {
                padding: 1.5rem;
            }

            .search-header h2 {
                font-size: 1.5rem;
            }

            .country-info {
                flex-direction: column;
                text-align: center;
            }

            .country-flag {
                margin: 0 0 1rem 0;
                width: 120px;
                height: 90px;
            }

            .tabs {
                flex-direction: column;
                gap: 0.5rem;
            }

            .tab {
                width: 100%;
                text-align: center;
            }

            .tab-content {
                padding: 1.5rem;
            }

            .vaccine-item {
                padding: 1.25rem;
            }

            button {
                padding: 0.875rem;
                font-size: 1rem;
            }

            select {
                padding: 0.875rem;
            }

            header {
                padding: 2rem 1rem;
                min-height: auto;
            }

            .logo h1 {
                font-size: 2rem;
            }

            .logo-icon {
                font-size: 2.5rem;
            }

            .header-stats {
                flex-direction: column;
                gap: 1rem;
            }

            .stat-item {
                width: 100%;
                text-align: center;
            }

            .medical-conditions-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        /* Tablet Optimizations */
        @media (min-width: 769px) and (max-width: 1024px) {
            .container {
                padding: 0 2rem;
            }

            .search-container {
                max-width: 90%;
                margin: 2rem auto;
            }
        }

        /* Print Styles */
        @media print {
            .search-container, .tabs, button {
                display: none;
            }

            .results-container {
                display: block;
                box-shadow: none;
            }

            body {
                background: white;
            }
        }

        /* Vaccine Details Modal */
        .vaccine-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            position: relative;
            background: white;
            width: 90%;
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #eee;
        }

        .modal-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin: 0;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            padding: 0.5rem;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: var(--danger-color);
        }

        .vaccine-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .detail-section {
            background: var(--light-gradient);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .detail-section h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .detail-list {
            list-style: none;
            padding: 0;
        }

        .detail-list li {
            margin-bottom: 0.75rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .detail-list li::before {
            content: '•';
            color: var(--primary-color);
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .severity-indicator {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .severity-high {
            background: rgba(234, 67, 53, 0.1);
            color: var(--danger-color);
        }

        .severity-medium {
            background: rgba(251, 188, 5, 0.1);
            color: #d18700;
        }

        .severity-low {
            background: rgba(52, 168, 83, 0.1);
            color: var(--secondary-color);
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Welcome Page Styles */
        .welcome-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: transform 0.5s ease-out, opacity 0.5s ease-out;
        }

        .welcome-content {
            text-align: center;
            color: white;
            padding: 2rem;
            max-width: 600px;
            position: relative;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .welcome-logo {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: welcomeLogo 2s ease-in-out infinite;
            display: inline-block;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .welcome-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.8s ease-out forwards;
        }

        .welcome-subtitle {
            font-size: 1.4rem;
            margin-bottom: 1rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.8s ease-out 0.2s forwards;
            color: rgba(255, 255, 255, 0.9);
        }

        .welcome-tagline {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            font-style: italic;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.8s ease-out 0.3s forwards;
            color: rgba(255, 255, 255, 0.8);
        }

        .welcome-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .enter-button, .explore-button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 1rem 2.5rem;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            opacity: 0;
            transform: translateY(20px);
            position: relative;
            overflow: hidden;
            min-width: 200px;
        }

        .enter-button {
            animation: fadeInUp 0.8s ease-out 0.4s forwards;
            background: rgba(255, 255, 255, 0.3);
        }

        .explore-button {
            animation: fadeInUp 0.8s ease-out 0.6s forwards;
        }

        .enter-button:hover, .explore-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.4);
        }

        .button-icon {
            margin-right: 0.8rem;
            display: inline-block;
            transform: translateY(1px);
            font-size: 1.4rem;
        }

        .floating-icon {
            position: absolute;
            font-size: 2.5rem;
            opacity: 0.2;
            animation: floatIcon 6s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
        }

        .floating-icon:nth-child(1) { top: 15%; left: 10%; animation-delay: 0s; font-size: 3rem; }
        .floating-icon:nth-child(2) { top: 65%; left: 15%; animation-delay: -1s; font-size: 2.5rem; }
        .floating-icon:nth-child(3) { top: 25%; right: 15%; animation-delay: -2s; font-size: 3.5rem; }
        .floating-icon:nth-child(4) { top: 75%; right: 10%; animation-delay: -3s; font-size: 2.8rem; }

        .quote-slideshow {
            position: relative;
            max-width: 800px;
            margin: 2rem auto 0;
            padding: 1.5rem;
            overflow: hidden;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes welcomeLogo {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes floatIcon {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(15px, -15px) rotate(10deg); }
        }

        .loader-scene, .doctor, .patient, .syringe, .medicine, .heart, .sparkle {
            animation-duration: 1.5s;
            animation-timing-function: ease-in-out;
        }

        @keyframes floatDoctor {
            0%, 100% {
                transform: translateY(0);
            }
            20% {
                transform: translateY(-20px);
            }
            50% {
                transform: translateY(-40px);
            }
            80% {
                transform: translateY(-20px);
            }
        }

        @keyframes floatPatient {
            0%, 100% {
                transform: translateY(0);
            }
            25% {
                transform: translateY(-30px);
            }
            50% {
                transform: translateY(-60px);
            }
            75% {
                transform: translateY(-30px);
            }
        }

        @keyframes floatSyringe {
            0%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-40px);
            }
            60% {
                transform: translateY(-80px);
            }
            90% {
                transform: translateY(-40px);
            }
        }

        @keyframes floatMedicine {
            0%, 100% {
                transform: translateY(0);
            }
            15% {
                transform: translateY(-20px);
            }
            45% {
                transform: translateY(-50px);
            }
            70% {
                transform: translateY(-20px);
            }
        }

        @keyframes floatHeart {
            0%, 100% {
                transform: translateY(0);
            }
            10% {
                transform: translateY(-10px);
            }
            40% {
                transform: translateY(-30px);
            }
            65% {
                transform: translateY(-10px);
            }
        }

        @keyframes floatSparkle {
            0%, 100% {
                transform: translateY(0);
            }
            20% {
                transform: translateY(-16px);
            }
            50% {
                transform: translateY(-36px);
            }
            80% {
                transform: translateY(-16px);
            }
        }

        .doctor {
            animation: floatDoctor 1.5s ease-in-out infinite;
        }

        .patient {
            animation: floatPatient 1.8s ease-in-out infinite;
        }

        .syringe {
            animation: floatSyringe 2s ease-in-out infinite;
        }

        .medicine {
            animation: floatMedicine 1.6s ease-in-out infinite;
        }

        .heart {
            animation: floatHeart 1.2s ease-in-out infinite;
        }

        .sparkle {
            animation: floatSparkle 1.9s ease-in-out infinite;
        }

        .transition-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: white;
            opacity: 0;
            animation: quickFadeInOut 0.5s ease-in-out forwards;
            z-index: 1001;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        @keyframes quickFadeInOut {
            0% { opacity: 0; transform: translate(-50%, -40%); }
            50% { opacity: 1; transform: translate(-50%, -50%); }
            100% { opacity: 0; transform: translate(-50%, -60%); }
        }

        .medical-conditions-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            background: var(--light-bg);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 0.5rem;
        }

        .condition-category {
            background: rgba(255, 255, 255, 0.8);
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .condition-category h4 {
            color: var(--primary-color);
            margin-bottom: 0.8rem;
            font-size: 1rem;
            border-bottom: 2px solid var(--light-bg);
            padding-bottom: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .checkbox-label:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .checkbox-label input {
            margin-right: 0.5rem;
            cursor: pointer;
        }

        .personal-tips {
            margin-top: 1rem;
        }

        .personal-tip-item {
            background: var(--light-gradient);
            margin-bottom: 1.25rem;
            padding: 1.25rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }

        .personal-tip-item:hover {
            transform: translateX(5px);
            box-shadow: var(--hover-shadow);
        }

        .personal-tip-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }

        .personal-tip-icon {
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }

        .medication-info {
            margin-top: 1rem;
        }

        .medication-category {
            margin-bottom: 2rem;
        }

        .medication-category-title {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light-bg);
        }

        .medication-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .medication-item {
            background: var(--light-gradient);
            padding: 1.25rem;
            border-radius: 10px;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }

        .medication-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--hover-shadow);
        }

        .medication-name {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }

        .medication-icon {
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }

        .medication-description {
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .medication-dosage {
            font-size: 0.9rem;
            color: #666;
        }

        .medication-note {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            font-style: italic;
            color: #666;
        }

        @media (max-width: 768px) {
            .medication-list {
                grid-template-columns: 1fr;
            }
        }

        /* New Modern Loader Animation */
        .modern-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem auto;
            text-align: center;
            position: relative;
            width: 300px;
            height: 300px;
            background: transparent;
            border-radius: 20px;
            overflow: hidden;
            flex-direction: column;
        }
        
        .globe-container {
            position: relative;
            width: 180px;
            height: 180px;
            margin-bottom: 20px;
        }
        
        .globe {
            position: absolute;
            width: 150px;
            height: 150px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            border-radius: 50%;
            top: 15px;
            left: 15px;
            overflow: hidden;
            box-shadow: 
                inset 0 0 20px rgba(255, 255, 255, 0.8),
                0 0 15px rgba(79, 172, 254, 0.6);
            animation: globePulse 3s ease-in-out infinite;
        }
        
        .globe::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6bm9uZTtzdHJva2U6cmdiYSgyNTUsMjU1LDI1NSwwLjMpO3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS13aWR0aDowLjc1cHg7fTwvc3R5bGU+PC9kZWZzPjxjaXJjbGUgY2xhc3M9ImNscy0xIiBjeD0iMTAwIiBjeT0iMTAwIiByPSI5OSIvPjxjaXJjbGUgY2xhc3M9ImNscy0xIiBjeD0iMTAwIiBjeT0iMTAwIiByPSI2NiIvPjxjaXJjbGUgY2xhc3M9ImNscy0xIiBjeD0iMTAwIiBjeT0iMTAwIiByPSIzMyIvPjxsaW5lIGNsYXNzPSJjbHMtMSIgeDE9IjEiIHkxPSIxMDAiIHgyPSIxOTkiIHkyPSIxMDAiLz48bGluZSBjbGFzcz0iY2xzLTEiIHgxPSIxMDAiIHkxPSIxIiB4Mj0iMTAwIiB5Mj0iMTk5Ii8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTAwLDFhMTgzLjQ4LDE4My40OCwwLDAsMSwwLDE5OCIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTEwMCwxYTE4My40OCwxODMuNDgsMCwwLDAsMCwxOTgiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik0zNCw1MGExNTYuMTYsMTU2LjE2LDAsMCwwLDAsMTAwIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTY2LDUwYTE1Ni4xNiwxNTYuMTYsMCwwLDAsMCwxMDAiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik0xLDUwQTE1Ni4xNiwxNTYuMTYsMCwwLDEsMTk5LDUwIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMSwxNTBBMTU2LjE2LDE1Ni4xNiwwLDAsMSwxOTksMTUwIi8+PC9zdmc+');
            background-size: 75% 75%;
            background-position: center;
            background-repeat: no-repeat;
            animation: globeRotate 20s linear infinite;
            opacity: 0.7;
        }
        
        .globe::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.4) 0%, transparent 80%);
            border-radius: 50%;
        }
        
        .plane {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: transparent;
            color: #fff;
            font-size: 25px;
            top: 75px;
            left: 75px;
            z-index: 10;
            animation: planeOrbit 8s linear infinite;
            transform-origin: center;
        }
        
        .vaccine-icon {
            position: absolute;
            width: 30px;
            height: 30px;
            color: #fff;
            font-size: 25px;
            top: 35px;
            left: 75px;
            z-index: 10;
            animation: vaccineOrbit 12s linear infinite reverse;
            transform-origin: center;
        }
        
        .health-icon {
            position: absolute;
            width: 30px;
            height: 30px;
            color: #fff;
            font-size: 25px;
            top: 75px;
            left: 35px;
            z-index: 10;
            animation: healthOrbit 10s linear infinite;
            transform-origin: center;
        }
        
        .orbit {
            position: absolute;
            width: 220px;
            height: 220px;
            border-radius: 50%;
            border: 1px dashed rgba(255, 255, 255, 0.3);
            top: -20px;
            left: -20px;
            z-index: 1;
        }
        
        .loading-bar-container {
            position: relative;
            width: 200px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .loading-bar {
            position: absolute;
            height: 100%;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            border-radius: 10px;
            animation: loadingProgress 2.5s ease-in-out infinite;
        }
        
        .loading-message {
            font-size: 1.1rem;
            color: #4facfe;
            font-weight: 500;
            margin-bottom: 10px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .status-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
            opacity: 0.8;
        }
        
        @keyframes globeRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes globePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes planeOrbit {
            0% { transform: rotate(0deg) translateX(80px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(80px) rotate(-360deg); }
        }
        
        @keyframes vaccineOrbit {
            0% { transform: rotate(0deg) translateX(60px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(60px) rotate(-360deg); }
        }
        
        @keyframes healthOrbit {
            0% { transform: rotate(0deg) translateX(75px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(75px) rotate(-360deg); }
        }
        
        @keyframes loadingProgress {
            0% { width: 0%; }
            25% { width: 50%; }
            50% { width: 70%; }
            75% { width: 85%; }
            100% { width: 100%; }
        }

        .status-change {
            animation: statusChange 10s linear infinite;
        }

        @keyframes statusChange {
            0%, 20% { opacity: 1; }
            25%, 95% { opacity: 0; }
            100% { opacity: 1; }
        }

        /* Chat Interface Styles */
        .chat-container {
            margin-top: 2rem;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            background: white;
            box-shadow: var(--card-shadow);
        }

        .chat-header {
            background: var(--primary-gradient);
            color: white;
            padding: 1rem;
            font-size: 1.1rem;
        }

        .chat-messages {
            height: 300px;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .chat-message {
            padding: 0.8rem 1rem;
            border-radius: 10px;
            max-width: 80%;
            animation: messageAppear 0.3s ease-out;
        }

        .user-message {
            background: var(--primary-gradient);
            color: white;
            align-self: flex-end;
        }

        .bot-message {
            background: var(--light-bg);
            color: var(--text-color);
            align-self: flex-start;
        }

        .chat-input-container {
            display: flex;
            padding: 1rem;
            gap: 0.5rem;
            border-top: 1px solid #e0e0e0;
        }

        #chatInput {
            flex: 1;
            padding: 0.8rem;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1rem;
        }

        #sendMessage {
            padding: 0.8rem 1.5rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #sendMessage:hover {
            transform: translateY(-2px);
        }

        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .chat-messages {
                height: 250px;
            }
            
            .chat-message {
                max-width: 90%;
            }
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .medication-loading {
            text-align: center;
            padding: 2rem;
            background: var(--light-bg);
            border-radius: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .medication-recommendations {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .custom-conditions {
            padding: 0.5rem 0;
        }

        .custom-condition-input {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .custom-condition-field {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .add-condition-btn {
            padding: 0.5rem 1rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .custom-conditions-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .custom-condition-tag {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            background: var(--light-gradient);
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .remove-condition {
            cursor: pointer;
            color: var(--danger-color);
            font-weight: bold;
        }

        .custom-condition-tag:hover {
            background: var(--primary-gradient);
            color: white;
        }

        .condition-description {
            display: none;
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
        }

        .condition-description textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 0.9rem;
            resize: vertical;
            min-height: 60px;
        }

        .description-toggle {
            font-size: 0.8rem;
            color: var(--primary-color);
            text-decoration: underline;
            cursor: pointer;
            margin-left: 0.5rem;
        }

        .description-toggle:hover {
            color: var(--secondary-color);
        }

        .has-description {
            border-left: 3px solid var(--primary-color);
            padding-left: 0.5rem;
        }

        .condition-summary {
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.25rem;
            font-style: italic;
        }

        .custom-condition-details {
            margin-top: 0.5rem;
        }

        .custom-condition-form {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .custom-condition-form input,
        .custom-condition-form textarea {
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .custom-condition-form textarea {
            resize: vertical;
            min-height: 60px;
        }

        .condition-tag-content {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .condition-description-preview {
            font-size: 0.8rem;
            color: #666;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Add these risk level color classes */
        .risk-high {
            background: linear-gradient(to right, rgba(255, 99, 71, 0.2), rgba(255, 99, 71, 0.1));
            border-left: 4px solid #ff6347;
        }

        .risk-medium {
            background: linear-gradient(to right, rgba(255, 165, 0, 0.2), rgba(255, 165, 0, 0.1));
            border-left: 4px solid #ffa500;
        }

        .risk-low {
            background: linear-gradient(to right, rgba(144, 238, 144, 0.2), rgba(144, 238, 144, 0.1));
            border-left: 4px solid #90ee90;
        }

        .risk-level-indicator {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 8px;
        }

        .risk-level-high {
            background-color: rgba(255, 99, 71, 0.2);
            color: #d63031;
        }

        .risk-level-medium {
            background-color: rgba(255, 165, 0, 0.2);
            color: #e17055;
        }

        .risk-level-low {
            background-color: rgba(144, 238, 144, 0.2);
            color: #00b894;
        }

        .vaccine-card {
            transition: all 0.3s ease;
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .vaccine-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .universal-health-info {
            background: linear-gradient(to right, rgba(100, 149, 237, 0.1), rgba(100, 149, 237, 0.05));
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid cornflowerblue;
        }

        .universal-health-info textarea {
            width: 100%;
            min-height: 100px;
            padding: 0.8rem;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            margin-top: 0.5rem;
            resize: vertical;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        .universal-health-info textarea:focus {
            border-color: cornflowerblue;
            outline: none;
            box-shadow: 0 0 0 2px rgba(100, 149, 237, 0.2);
        }

        .universal-health-info h3 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .health-info-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .health-info-category {
            background: white;
            padding: 0.8rem;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }

        .health-info-category h4 {
            color: #34495e;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .health-info-category ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .health-info-category li {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.3rem;
        }

        .health-info-preview {
            background: rgba(255, 255, 255, 0.8);
            padding: 0.8rem;
            border-radius: 5px;
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #666;
            display: none;
        }
    </style>
</head>
<body>
    <div class="welcome-page" id="welcomePage">
        <div class="welcome-icons">
            <div class="floating-icon">✈️</div>
            <div class="floating-icon">🌍</div>
            <div class="floating-icon">🏥</div>
            <div class="floating-icon">🧬</div>
        </div>
        <div class="welcome-content">
            <div class="welcome-logo">💉</div>
            <h1 class="welcome-title">TravelVax</h1>
            <p class="welcome-subtitle">Your Health Passport to the World</p>
            <p class="welcome-tagline">"Because every journey begins with safety"</p>
            <div class="welcome-buttons">
                <button class="enter-button" onclick="enterWebsite()">
                    <span class="button-icon">🚀</span>Begin Journey
                </button>
            </div>
        </div>
        <div class="quote-slideshow">
            <div class="quote-slide active">
                <p class="quote-text">"The greatest wealth is health. Protect it wherever your adventures take you."</p>
                <p class="quote-author">- Ancient Wisdom</p>
            </div>
            <div class="quote-slide">
                <p class="quote-text">"Travel makes one modest. You see what a tiny place you occupy in the world."</p>
                <p class="quote-author">- Gustave Flaubert</p>
            </div>
            <div class="quote-slide">
                <p class="quote-text">"Prevention is better than cure, especially when exploring the world."</p>
                <p class="quote-author">- TravelVax Motto</p>
            </div>
            <div class="quote-slide">
                <p class="quote-text">"The world is a book, and those who do not travel read only one page. Travel safely."</p>
                <p class="quote-author">- Saint Augustine</p>
            </div>
            <div class="quote-nav"></div>
        </div>
    </div>

    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">💉</div>
                <h1>TravelVax</h1>
            </div>
            <p class="header-text">Your trusted companion for safe and healthy travel. Get personalized vaccine recommendations for your destinations.</p>
            <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-number">200+</div>
                    <div class="stat-label">Countries</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">50+</div>
                    <div class="stat-label">Vaccines</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">24/7</div>
                    <div class="stat-label">Support</div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="search-container">
            <div class="search-header">
                <h2>Find Travel Vaccine Recommendations</h2>
                <p>Select a country to see recommended vaccinations for your trip</p>
            </div>
            
            <div class="error-message" id="errorMessage"></div>
            
            <form class="search-form" id="searchForm">
                <div class="form-group">
                    <label for="country">Destination Country:</label>
                    <select id="country" required>
                        <option value="">Select a country</option>
                        <!-- Countries will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="age">Your Age:</label>
                    <input type="number" id="age" name="age" min="1" max="120" placeholder="Enter your age">
                </div>

                <div class="universal-health-info">
                    <h3>General Health Information</h3>
                    <p class="text-muted">Provide overall information about your health status, medications, and any relevant medical details.</p>
                    <textarea id="universalHealthInfo" placeholder="Example: I take daily medications for blood pressure and diabetes. I have mild asthma triggered by humidity. I'm allergic to penicillin. I had knee surgery 2 years ago..."></textarea>
                    <div class="health-info-categories">
                        <div class="health-info-category">
                            <h4>Suggested Information to Include:</h4>
                            <ul>
                                <li>• Current medications and dosages</li>
                                <li>• Known allergies</li>
                                <li>• Recent surgeries or procedures</li>
                                <li>• Chronic condition details</li>
                                <li>• Physical limitations</li>
                            </ul>
                        </div>
                        <div class="health-info-category">
                            <h4>Medical History Highlights:</h4>
                            <ul>
                                <li>• Past major illnesses</li>
                                <li>• Family health history</li>
                                <li>• Regular treatments</li>
                                <li>• Emergency contacts</li>
                                <li>• Blood type</li>
                            </ul>
                        </div>
                    </div>
                    <div id="healthInfoPreview" class="health-info-preview"></div>
                </div>

                <div class="form-group">
                    <label>Medical Conditions (if any):</label>
                    <div class="medical-conditions-container">
                        <div class="condition-category">
                            <h4>Common Conditions</h4>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="diabetes"> Diabetes
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="pregnancy"> Pregnancy
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="heart"> Heart Conditions
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="immune"> Immune Deficiency
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="respiratory"> Respiratory Issues
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="hypertension"> Hypertension
                            </label>
                        </div>
                        <div class="condition-category">
                            <h4>Chronic Conditions</h4>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="arthritis"> Arthritis
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="asthma"> Asthma
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="cancer"> Cancer
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="epilepsy"> Epilepsy
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="thyroid"> Thyroid Disorders
                            </label>
                        </div>
                        <div class="condition-category">
                            <h4>Allergies</h4>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="drug_allergies"> Drug Allergies
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="food_allergies"> Food Allergies
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="latex"> Latex Allergy
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="environmental"> Environmental Allergies
                            </label>
                        </div>
                        <div class="condition-category">
                            <h4>Mental Health</h4>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="anxiety"> Anxiety Disorder
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="depression"> Depression
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="panic"> Panic Disorder
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="ptsd"> PTSD
                            </label>
                        </div>
                        <div class="condition-category">
                            <h4>Other Conditions</h4>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="blood_disorders"> Blood Disorders
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="autoimmune"> Autoimmune Disorders
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="motion_sickness"> Motion Sickness
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="sleep_disorders"> Sleep Disorders
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="conditions" value="skin_conditions"> Skin Conditions
                            </label>
                        </div>
                        <div class="condition-category">
                            <h4>Custom Health Conditions</h4>
                            <div class="custom-conditions">
                                <div class="custom-condition-input">
                                    <input type="text" id="newCondition" placeholder="Enter your condition" class="custom-condition-field">
                                    <button type="button" onclick="addCustomCondition()" class="add-condition-btn">Add</button>
                                </div>
                                <div id="customConditionsList" class="custom-conditions-list">
                                    <!-- Custom conditions will be added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button type="submit">Get Recommendations</button>
            </form>
        </div>
        
        <div class="loader" id="loader">
            <div class="modern-loader">
                <div class="globe-container">
                    <div class="orbit"></div>
                    <div class="globe"></div>
                    <div class="plane">✈️</div>
                    <div class="vaccine-icon">💉</div>
                    <div class="health-icon">🩺</div>
                </div>
                <div class="loading-message">Preparing Your Travel Health Plan</div>
                <div class="loading-bar-container">
                    <div class="loading-bar"></div>
                </div>
                <div class="status-text status-change">Analyzing destination health data...</div>
            </div>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <div class="country-info" id="countryInfo">
                <!-- Will be populated by JavaScript -->
            </div>
            
            <div class="alert alert-info">
                <strong>Note:</strong> These recommendations are general guidelines. Please consult with a healthcare provider for personalized medical advice.
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="vaccines">Recommended Vaccines</div>
                <div class="tab" data-tab="personal">Personal Tips</div>
                <div class="tab" data-tab="medications">Medications</div>
                <div class="tab" data-tab="health">Health Info</div>
                <div class="tab" data-tab="tips">Travel Tips</div>
            </div>
            
            <div class="tab-content active" id="vaccinesTab">
                <h3 class="vaccines-header">Recommended Vaccines</h3>
                <ul class="vaccine-list" id="vaccineList">
                    <!-- Will be populated by JavaScript -->
                </ul>
            </div>
            
            <div class="tab-content" id="personalTab">
                <h3>Personalized Health Recommendations</h3>
                <div class="personal-tips" id="personalTips">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <!-- Chat Interface -->
                <div class="chat-container" style="margin-top: 2rem; border: 1px solid #e0e0e0; border-radius: 10px; overflow: hidden; background: white; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                    <div class="chat-header" style="background: linear-gradient(135deg, #4285f4, #34a853); color: white; padding: 1rem;">
                        <h4>💬 Chat with TravelHealth Assistant</h4>
                    </div>
                    <div id="chatMessages" style="height: 300px; overflow-y: auto; padding: 1rem;"></div>
                    <div style="display: flex; padding: 1rem; gap: 0.5rem; border-top: 1px solid #e0e0e0;">
                        <input type="text" id="chatInput" placeholder="Ask about your health concerns..." 
                               style="flex: 1; padding: 0.8rem; border: 1px solid #e0e0e0; border-radius: 5px;">
                        <button onclick="sendMessage()" style="padding: 0.8rem 1.5rem; background: linear-gradient(135deg, #4285f4, #34a853); color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Send
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="medicationsTab">
                <h3>Recommended Medications</h3>
                <div class="medication-info" id="medicationInfo">
                    <div class="alert alert-info">
                        Select one or more medical conditions in the search form to see recommended medications.
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="healthTab">
                <h3>Local Health Information</h3>
                <div class="health-facts" id="healthInfo">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="tab-content" id="tipsTab">
                <h3>Travel Health Tips</h3>
                <div class="travel-tips">
                    <ul class="tips-list">
                        <li><span class="tip-icon">✓</span> Schedule your vaccines 4-6 weeks before travel to ensure full immunity</li>
                        <li><span class="tip-icon">✓</span> Carry a record of your vaccinations during your trip</li>
                        <li><span class="tip-icon">✓</span> Pack a travel health kit with first-aid supplies and medications</li>
                        <li><span class="tip-icon">✓</span> Research healthcare facilities at your destination before departing</li>
                        <li><span class="tip-icon">✓</span> Check if travel insurance covers medical evacuation in emergencies</li>
                        <li><span class="tip-icon">✓</span> Keep hydrated and use safe water sources</li>
                        <li><span class="tip-icon">✓</span> Use insect repellent in areas with mosquito-borne diseases</li>
                        <li><span class="tip-icon">✓</span> Avoid eating uncooked foods or drinking untreated water</li>
                        <li><span class="tip-icon">✓</span> Bring prescription medications in original packaging with doctor's notes</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>&copy; 2025 TravelVax | Providing travel health information</p>
        <p>This site provides information for educational purposes only. Always consult a healthcare professional before travel.</p>
    </footer>

    <script>
        // DOM Elements
        const countrySelect = document.getElementById('country');
        const searchForm = document.getElementById('searchForm');
        const loader = document.getElementById('loader');
        const resultsContainer = document.getElementById('resultsContainer');
        const countryInfo = document.getElementById('countryInfo');
        const vaccineList = document.getElementById('vaccineList');
        const healthInfo = document.getElementById('healthInfo');
        const personalTips = document.getElementById('personalTips');
        const medicationInfo = document.getElementById('medicationInfo');
        const errorMessage = document.getElementById('errorMessage');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // API endpoints and configuration
        const REST_COUNTRIES_API = 'https://restcountries.com/v3.1';
        const GEMINI_API_KEY = 'AIzaSyCBhTkjvvVDYopdn8_MPv6fTalSMTsSW3c';
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1/models/gemini-1.5-pro:generateContent';

        // Function to call Gemini API with safety settings
        async function callGeminiAPI(prompt) {
            try {
                console.log('Calling Gemini 1.5 Pro API...');
                
                if (!GEMINI_API_KEY) {
                    throw new Error('Please configure a valid Gemini API key');
                }

                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        safetySettings: [
                            {
                                category: "HARM_CATEGORY_HARASSMENT",
                                threshold: "BLOCK_NONE"
                            },
                            {
                                category: "HARM_CATEGORY_HATE_SPEECH",
                                threshold: "BLOCK_NONE"
                            },
                            {
                                category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                                threshold: "BLOCK_NONE"
                            },
                            {
                                category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                                threshold: "BLOCK_NONE"
                            }
                        ],
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 1024
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.text();
                    console.error('Gemini API Error Response:', errorData);
                    throw new Error(`Gemini API failed with status: ${response.status}. ${errorData}`);
                }

                const data = await response.json();
                console.log('Gemini API Response:', data);
                
                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
                    throw new Error('Invalid response format from Gemini API');
                }

                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error('Error calling Gemini API:', error.message);
                showError(`API Error: ${error.message}. Using fallback data.`);
                return null;
            }
        }

        // Fetch countries from REST Countries API
        async function fetchCountries() {
            showLoader();
            try {
                console.log('Fetching countries from REST Countries API...');
                const response = await fetch('https://restcountries.com/v3.1/all');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (!Array.isArray(data) || data.length === 0) {
                    throw new Error('Invalid response format from REST Countries API');
                }
                
                console.log(`Successfully fetched ${data.length} countries`);
                
                // Sort countries alphabetically by name
                data.sort((a, b) => a.name.common.localeCompare(b.name.common));
                
                // Store the data globally for later use
                window.countriesData = data;
                
                // Populate the dropdown
                const countrySelect = document.getElementById('country');
                if (!countrySelect) {
                    throw new Error('Country select element not found in DOM');
                }
                
                // Clear existing options
                countrySelect.innerHTML = '<option value="">Select a country</option>';
                
                // Add countries to dropdown
                data.forEach(country => {
                    if (country.name && country.name.common) {
                        const option = document.createElement('option');
                        option.value = country.name.common;
                        option.textContent = country.name.common;
                        countrySelect.appendChild(option);
                    }
                });
                
                console.log('Countries dropdown populated successfully');
            } catch (error) {
                console.error('Error fetching countries:', error);
                showError(`Failed to load countries: ${error.message}. Please refresh the page.`);
                
                // Add fallback countries in case of API failure
                const countrySelect = document.getElementById('country');
                if (countrySelect) {
                    countrySelect.innerHTML = '<option value="">Select a country</option>';
                    const fallbackCountries = [
                        'United States', 'United Kingdom', 'Canada', 'Australia', 
                        'Germany', 'France', 'Japan', 'China', 'India', 'Brazil'
                    ];
                    fallbackCountries.forEach(country => {
                        const option = document.createElement('option');
                        option.value = country;
                        option.textContent = country;
                        countrySelect.appendChild(option);
                    });
                }
            } finally {
                hideLoader();
            }
        }

        // Get vaccine recommendations based on country data
        async function getVaccineRecommendations(countryName) {
            showLoader();
            
            try {
                // Find the country data from our stored data
                const countryData = window.countriesData.find(c => c.name.common === countryName);
                
                if (!countryData) {
                    throw new Error('Country data not found');
                }

                // Get user age and medical conditions
                const ageInput = document.getElementById('age');
                const age = ageInput && ageInput.value ? parseInt(ageInput.value) : null;
                const selectedConditions = Array.from(document.querySelectorAll('input[name="conditions"]:checked')).map(checkbox => checkbox.value);

                console.log('Selected Country Data:', countryData);
                console.log('User Age:', age);
                console.log('User Medical Conditions:', selectedConditions);

                // Generate vaccine recommendations using Gemini API
                const vaccinePrompt = `You are a medical expert providing vaccine recommendations for travelers. 
                Generate a specific list of recommended vaccines for travelers visiting ${countryData.name.common}. 
                
                Country Information:
                - Region: ${countryData.region}${countryData.subregion ? ` (${countryData.subregion})` : ''}
                - Population: ${countryData.population}
                - Languages: ${Object.values(countryData.languages || {}).join(', ')}
                - Capital: ${countryData.capital?.[0] || 'N/A'}
                
                Return ONLY a JSON array of vaccine objects in this exact format:
                [
                    {
                        "name": "vaccine name",
                        "description": "specific reason for this vaccine in this country",
                        "requirement": "Required/Recommended/Routine",
                        "riskLevel": "High/Medium/Low"
                    }
                ]`;

                const vaccineResponse = await callGeminiAPI(vaccinePrompt);
                let vaccines = [];

                if (vaccineResponse) {
                    try {
                        // Clean the response to extract only the JSON array
                        const cleanedResponse = vaccineResponse
                            .replace(/```json/g, '')
                            .replace(/```/g, '')
                            .trim();
                        
                        console.log('Cleaned Vaccine Response:', cleanedResponse);
                        
                        // Try to parse the JSON
                        const parsedVaccines = JSON.parse(cleanedResponse);
                        console.log('Parsed Vaccine Data:', parsedVaccines);
                        
                        if (Array.isArray(parsedVaccines) && parsedVaccines.length > 0) {
                            vaccines = parsedVaccines;
                        }
                    } catch (error) {
                        console.error('Error parsing vaccine data:', error);
                        vaccines = getFallbackVaccines(countryData);
                    }
                } else {
                    vaccines = getFallbackVaccines(countryData);
                }

                // Generate health information using Gemini API
                const healthPrompt = `Generate comprehensive health information for travelers visiting ${countryData.name.common}.
                Consider the region, climate, healthcare infrastructure, and common health risks.
                Format the response in HTML with clear sections and bullet points.`;

                const healthInfo = await callGeminiAPI(healthPrompt) || generateHealthInfo(countryData);

                // Display results
                await displayResults(countryData, vaccines, healthInfo, null, generateMedicationRecommendations(selectedConditions, countryData));
            } catch (error) {
                console.error('Error:', error);
                showError('Failed to fetch recommendations. Please try again later.');
            } finally {
                hideLoader();
            }
        }

        // Generate health information based on country data
        function generateHealthInfo(countryData) {
            const info = [];
            
            // Basic health information
            info.push(`<p><strong>Region:</strong> ${countryData.region}${countryData.subregion ? ` (${countryData.subregion})` : ''}</p>`);
            
            // Population density consideration
            if (countryData.population > 100000000) {
                info.push(`<p><strong>Population Density:</strong> High population density may increase disease transmission risk.</p>`);
            }
            
            // Language information
            if (countryData.languages) {
                const languages = Object.values(countryData.languages).join(', ');
                info.push(`<p><strong>Languages:</strong> ${languages}</p>`);
            }
            
            // Currency information
            if (countryData.currencies) {
                const currencies = Object.values(countryData.currencies)
                    .map(curr => `${curr.name} (${curr.symbol || 'N/A'})`)
                    .join(', ');
                info.push(`<p><strong>Local Currency:</strong> ${currencies}</p>`);
            }
            
            // Capital information
            if (countryData.capital && countryData.capital.length > 0) {
                info.push(`<p><strong>Capital:</strong> ${countryData.capital[0]}</p>`);
            }
            
            // Region-specific health advice
            if (countryData.region === "Africa" || countryData.subregion?.includes("Africa")) {
                info.push(`
                    <p><strong>Health Considerations:</strong></p>
                    <ul>
                        <li>High risk of malaria in many regions</li>
                        <li>Food and water safety concerns</li>
                        <li>Limited healthcare access in rural areas</li>
                        <li>Yellow fever vaccination may be required</li>
                    </ul>
                `);
            } else if (countryData.region === "Asia" || countryData.subregion?.includes("Asia")) {
                info.push(`
                    <p><strong>Health Considerations:</strong></p>
                    <ul>
                        <li>Food and water safety varies by region</li>
                        <li>Air pollution in major cities</li>
                        <li>Healthcare quality varies significantly</li>
                        <li>High risk of food-borne illnesses</li>
                    </ul>
                `);
            } else if (countryData.region === "Americas" || countryData.subregion?.includes("America")) {
                info.push(`
                    <p><strong>Health Considerations:</strong></p>
                    <ul>
                        <li>Healthcare access varies by region</li>
                        <li>Altitude sickness in mountainous areas</li>
                        <li>Food safety varies by region</li>
                        <li>Mosquito-borne diseases in tropical areas</li>
                    </ul>
                `);
            }
            
            return info.join('');
        }

        // Display results
        async function displayResults(countryData, vaccineData, healthData, personalTipsData, medicationData) {
            // Update country info with proper flag URL
            countryInfo.innerHTML = `
                <img class="country-flag" src="${countryData.flags.png}" 
                     alt="${countryData.name.common} flag" 
                     onerror="this.onerror=null; this.src='https://flagcdn.com/w160/${countryData.cca2.toLowerCase()}.png';">
                <div>
                    <h2>${countryData.name.common}</h2>
                    <p>Region: ${countryData.region}${countryData.subregion ? ` (${countryData.subregion})` : ''}</p>
                </div>
            `;
            
            // Clear previous vaccine list
            vaccineList.innerHTML = '';
            
            // Sort and display vaccines
            vaccineData.sort((a, b) => {
                const reqPriority = { required: 0, recommended: 1, routine: 2 };
                const reqDiff = (reqPriority[a.requirement.toLowerCase()] || 3) - (reqPriority[b.requirement.toLowerCase()] || 3);
                if (reqDiff !== 0) return reqDiff;
                
                const riskPriority = { high: 0, medium: 1, low: 2 };
                return (riskPriority[a.riskLevel.toLowerCase()] || 3) - (riskPriority[b.riskLevel.toLowerCase()] || 3);
            });
            
            vaccineData.forEach(vaccine => {
                const riskClass = vaccine.riskLevel.toLowerCase() === 'high' ? 'risk-high' : 
                                 vaccine.riskLevel.toLowerCase() === 'medium' ? 'risk-medium' : '';
                
                const reqLabel = vaccine.requirement.toLowerCase() === 'required' ? 
                                '<span style="color: #ea4335; font-weight: 600;">REQUIRED</span>' : 
                                (vaccine.requirement.toLowerCase() === 'recommended' ? 
                                '<span style="color: #fbbc05; font-weight: 600;">RECOMMENDED</span>' : 
                                '<span style="color: #34a853; font-weight: 600;">ROUTINE</span>');
                
                const li = document.createElement('li');
                li.className = `vaccine-item ${riskClass}`;
                li.innerHTML = `
                    <div class="vaccine-name">
                        <span class="vaccine-icon">💉</span> ${vaccine.name}
                    </div>
                    <div class="vaccine-info">${vaccine.description}</div>
                    <div>
                        <strong>Status:</strong> ${reqLabel} | 
                        <strong>Risk Level:</strong> ${vaccine.riskLevel}
                    </div>
                `;
                
                li.onclick = () => showVaccineDetails(vaccine);
                li.style.cursor = 'pointer';
                
                vaccineList.appendChild(li);
            });
            
            // Update health info
            healthInfo.innerHTML = healthData;

            try {
                // Generate and update personal tips
                const tips = await generatePersonalizedTips(countryData, 
                    document.getElementById('age').value,
                    Array.from(document.querySelectorAll('input[name="conditions"]:checked')).map(cb => cb.value),
                    vaccineData
                );
                personalTips.innerHTML = tips;
            } catch (error) {
                console.error('Error generating personal tips:', error);
                personalTips.innerHTML = `<div class="alert alert-warning">
                    <strong>Note:</strong> There was an issue generating personalized recommendations. 
                    Please try refreshing the page or contact support if the issue persists.
                </div>`;
            }
            
            // Update medication recommendations
            medicationInfo.innerHTML = medicationData;
            
            // Show results
            resultsContainer.style.display = 'block';
            
            // Reset to first tab
            tabs.forEach(tab => tab.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            document.querySelector('.tab[data-tab="vaccines"]').classList.add('active');
            document.getElementById('vaccinesTab').classList.add('active');
            
            // Scroll to results
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // Function to generate personalized tips based on age and medical conditions
        async function generatePersonalizedTips(countryData, age, conditions, vaccines) {
            if (!age && (!conditions || conditions.length === 0)) {
                return `<div class="alert alert-info">
                    Please provide your age and/or medical conditions for personalized health recommendations.
                </div>`;
            }

            try {
                const prompt = `As a medical travel expert, provide detailed personalized health recommendations for a traveler:

                Destination: ${countryData.name.common}
                Region: ${countryData.region}
                Age: ${age || 'Not specified'}
                
                General Health Information:
                ${universalHealthDescription || 'No general health information provided'}
                
                Selected Medical Conditions:
                ${conditions.map(condition => 
                    condition.startsWith('custom_') ? 
                    condition.replace('custom_', '').replace(/_/g, ' ') : 
                    condition
                ).join(', ')}
                
                Required Vaccines: ${vaccines.map(v => v.name).join(', ')}

                Please provide comprehensive HTML-formatted advice including:
                [Previous sections remain the same...]`;

                const response = await callGeminiAPI(prompt);
                
                if (response) {
                    return `
                        <div class="personalized-tips-container">
                            ${response}
                            <div class="alert alert-info mt-3">
                                <strong>Note:</strong> These recommendations are personalized based on your profile. Always consult with your healthcare provider before travel.
                            </div>
                        </div>
                    `;
                } else {
                    throw new Error('Failed to generate personalized recommendations');
                }
            } catch (error) {
                console.error('Error generating personalized tips:', error);
                return generateFallbackTips(countryData, age, conditions, vaccines);
            }
        }

        // Initialize chat functionality
        function initializeChat() {
            const chatInput = document.getElementById('chatInput');
            const sendButton = document.getElementById('sendMessage');
            const chatMessages = document.getElementById('chatMessages');
            
            // Welcome message
            addBotMessage("Hello! I'm your TravelHealth Assistant. How can I help you with your travel health concerns?");
            
            async function handleUserMessage(message) {
                // Add user message to chat
                addUserMessage(message);
                
                // Generate context-aware prompt
                const selectedCountry = document.getElementById('country').value;
                const age = document.getElementById('age').value;
                const conditions = Array.from(document.querySelectorAll('input[name="conditions"]:checked'))
                    .map(checkbox => checkbox.value);
                
                const chatPrompt = `As a medical travel expert, answer the following question for a traveler with this profile:

                Question: ${message}
                Destination: ${selectedCountry}
                Age: ${age || 'Not specified'}
                Medical Conditions: ${conditions.join(', ') || 'None specified'}
                
                Provide a clear, concise, and helpful response focusing on travel health aspects.`;
                
                try {
                    const response = await callGeminiAPI(chatPrompt);
                    if (response) {
                        addBotMessage(response);
                    } else {
                        addBotMessage("I apologize, but I'm having trouble generating a response. Please try asking your question in a different way.");
                    }
                } catch (error) {
                    console.error('Chat error:', error);
                    addBotMessage("I apologize, but I'm having trouble connecting. Please try again later.");
                }
            }
            
            function addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'chat-message user-message';
                messageDiv.textContent = message;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            function addBotMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'chat-message bot-message';
                messageDiv.innerHTML = message;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Event listeners
            sendButton.addEventListener('click', () => {
                const message = chatInput.value.trim();
                if (message) {
                    handleUserMessage(message);
                    chatInput.value = '';
                }
            });
            
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const message = chatInput.value.trim();
                    if (message) {
                        handleUserMessage(message);
                        chatInput.value = '';
                    }
                }
            });
        }

        // Initialize chat when document is ready
        document.addEventListener('DOMContentLoaded', () => {
            initializeChat();
        });

        // Function to generate medication recommendations based on conditions
        function generateMedicationRecommendations(conditions, countryData) {
            if (!conditions || conditions.length === 0) {
                return `<div class="alert alert-info">
                    Please select one or more medical conditions to see recommended medications.
                </div>`;
            }

            const medicationPrompt = `As a medical travel expert, provide medication recommendations for a traveler with the following conditions:
            Medical Conditions: ${conditions.join(', ')}
            Destination: ${countryData.name.common}
            Region: ${countryData.region}

            For each condition, provide:
            1. Essential medications
            2. Backup/emergency medications
            3. Over-the-counter supplements
            4. Special storage requirements
            5. Local availability information
            
            Format the response in HTML with clear sections for each condition.`;

            // Call Gemini API for medication recommendations
            callGeminiAPI(medicationPrompt).then(response => {
                if (response) {
                    medicationInfo.innerHTML = `
                        <div class="medication-recommendations">
                            ${response}
                        </div>
                    `;
                } else {
                    medicationInfo.innerHTML = generateFallbackMedications(conditions, countryData);
                }
            }).catch(error => {
                console.error('Error generating medication recommendations:', error);
                medicationInfo.innerHTML = generateFallbackMedications(conditions, countryData);
            });

            // Return loading state while API call is in progress
            return `<div class="medication-loading">
                <div class="loading-spinner"></div>
                <p>Generating medication recommendations...</p>
            </div>`;
        }

        // Fallback medication recommendations
        function generateFallbackMedications(conditions, countryData) {
            const recommendations = [];
            
            if (conditions.includes('diabetes')) {
                recommendations.push(`
                    <div class="medication-category">
                        <h4>Diabetes Medications</h4>
                        <div class="medication-list">
                            <div class="medication-item">
                                <div class="medication-name">
                                    <span class="medication-icon">💉</span> Insulin and Supplies
                                </div>
                                <div class="medication-description">
                                    <ul>
                                        <li>Bring extra insulin and supplies</li>
                                        <li>Pack insulin cooling case</li>
                                        <li>Carry prescription documentation</li>
                                        <li>Bring glucose monitoring supplies</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="medication-item">
                                <div class="medication-name">
                                    <span class="medication-icon">💊</span> Oral Medications
                                </div>
                                <div class="medication-description">
                                    <ul>
                                        <li>Pack metformin or other prescribed medications</li>
                                        <li>Bring backup prescriptions</li>
                                        <li>Consider time zone adjustments</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `);
            }

            if (conditions.includes('hypertension')) {
                recommendations.push(`
                    <div class="medication-category">
                        <h4>Blood Pressure Medications</h4>
                        <div class="medication-list">
                            <div class="medication-item">
                                <div class="medication-name">
                                    <span class="medication-icon">❤️</span> Essential Medications
                                </div>
                                <div class="medication-description">
                                    <ul>
                                        <li>Blood pressure medications (30-day supply)</li>
                                        <li>Backup prescriptions</li>
                                        <li>Blood pressure monitor</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `);
            }

            if (conditions.includes('respiratory')) {
                recommendations.push(`
                    <div class="medication-category">
                        <h4>Respiratory Medications</h4>
                        <div class="medication-list">
                            <div class="medication-item">
                                <div class="medication-name">
                                    <span class="medication-icon">🫁</span> Inhalers and Medications
                                </div>
                                <div class="medication-description">
                                    <ul>
                                        <li>Rescue inhaler (multiple)</li>
                                        <li>Maintenance inhalers</li>
                                        <li>Oral steroids if prescribed</li>
                                        <li>Peak flow meter</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `);
            }

            if (conditions.includes('allergies') || conditions.includes('food_allergies') || conditions.includes('drug_allergies')) {
                recommendations.push(`
                    <div class="medication-category">
                        <h4>Allergy Medications</h4>
                        <div class="medication-list">
                            <div class="medication-item">
                                <div class="medication-name">
                                    <span class="medication-icon">💊</span> Essential Medications
                                </div>
                                <div class="medication-description">
                                    <ul>
                                        <li>Antihistamines</li>
                                        <li>EpiPen if prescribed</li>
                                        <li>Allergy documentation</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `);
            }

            // Add general travel medications for all conditions
            recommendations.push(`
                <div class="medication-category">
                    <h4>General Travel Medications</h4>
                    <div class="medication-list">
                        <div class="medication-item">
                            <div class="medication-name">
                                <span class="medication-icon">🧳</span> Essential Travel Kit
                            </div>
                            <div class="medication-description">
                                <ul>
                                    <li>Pain relievers (acetaminophen/ibuprofen)</li>
                                    <li>Anti-diarrheal medication</li>
                                    <li>Basic first aid supplies</li>
                                    <li>Oral rehydration salts</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `);

            return `
                <div class="medication-recommendations">
                    ${recommendations.join('')}
                    <div class="alert alert-info mt-3">
                        <strong>Important:</strong> Always consult with your healthcare provider before travel and carry:
                        <ul>
                            <li>Original prescriptions and medical documentation</li>
                            <li>Letter from your doctor describing your conditions</li>
                            <li>Medications in original packaging</li>
                            <li>Extra supplies in case of travel delays</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // Show loader
        function showLoader() {
            loader.style.display = 'block';
            resultsContainer.style.display = 'none';
            errorMessage.style.display = 'none';
            
            const statusMessages = [
                'Analyzing destination health data...',
                'Checking regional disease risks...',
                'Reviewing vaccine requirements...',
                'Customizing recommendations...',
                'Preparing your personalized travel plan...',
                'Almost ready...'
            ];
            
            let messageIndex = 0;
            const statusText = document.querySelector('.status-text');
            
            // Clear any existing intervals
            if (window.statusInterval) {
                clearInterval(window.statusInterval);
            }
            
            // Update status message every 2.5 seconds
            window.statusInterval = setInterval(() => {
                messageIndex = (messageIndex + 1) % statusMessages.length;
                statusText.textContent = statusMessages[messageIndex];
            }, 2500);
        }
        
        // Hide loader
        function hideLoader() {
            loader.style.display = 'none';
            
            // Clear status message interval
            if (window.statusInterval) {
                clearInterval(window.statusInterval);
                window.statusInterval = null;
            }
        }
        
        // Show error message
        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            if (errorMessage) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                // Auto-hide error after 5 seconds
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 5000);
            }
            console.error(message);
        }
        
        // Tab functionality
        function setupTabs() {
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(`${tab.dataset.tab}Tab`).classList.add('active');
                });
            });
        }
        
        // Initialize the application
        function init() {
            // Fetch countries when the page loads
            fetchCountries();
            
            // Add form submission handler
            const searchForm = document.getElementById('searchForm');
            if (searchForm) {
                searchForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const countrySelect = document.getElementById('country');
                    if (!countrySelect) {
                        console.error('Country select element not found');
                        return;
                    }
                    
                    const selectedCountry = countrySelect.value;
                    if (!selectedCountry) {
                        showError('Please select a country');
                        return;
                    }
                    
                    // Get vaccine recommendations for the selected country
                    await getVaccineRecommendations(selectedCountry);
                });
            }
            
            // Setup tabs
            setupTabs();
        }

        // Call init when the document is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        // Add vaccine details functionality
        function showVaccineDetails(vaccine) {
            const modal = document.createElement('div');
            modal.className = 'vaccine-modal';
            
            const severityClass = vaccine.riskLevel.toLowerCase() === 'high' ? 'severity-high' :
                                vaccine.riskLevel.toLowerCase() === 'medium' ? 'severity-medium' :
                                'severity-low';

            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">${vaccine.name}</h2>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div class="vaccine-details">
                        <div class="detail-section">
                            <h3>Usage & Administration</h3>
                            <ul class="detail-list">
                                <li>Recommended for: ${vaccine.description}</li>
                                <li>Administration: ${getVaccineDetails(vaccine.name).administration}</li>
                                <li>Dosage: ${getVaccineDetails(vaccine.name).dosage}</li>
                                <li>Schedule: ${getVaccineDetails(vaccine.name).schedule}</li>
                            </ul>
                        </div>
                        <div class="detail-section">
                            <h3>Precautions & Contraindications</h3>
                            <ul class="detail-list">
                                ${getVaccineDetails(vaccine.name).precautions.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="detail-section">
                            <h3>Side Effects</h3>
                            <ul class="detail-list">
                                ${getVaccineDetails(vaccine.name).sideEffects.map(e => `<li>${e}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="detail-section">
                            <h3>Additional Information</h3>
                            <ul class="detail-list">
                                <li>Recommended Age: ${getVaccineDetails(vaccine.name).recommendedAge}</li>
                                <li>Severity: <span class="severity-indicator ${severityClass}">${vaccine.riskLevel}</span></li>
                                <li>Protection Duration: ${getVaccineDetails(vaccine.name).protectionDuration}</li>
                                <li>Storage Requirements: ${getVaccineDetails(vaccine.name).storage}</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
            modal.style.display = 'block';

            // Close modal functionality
            const closeBtn = modal.querySelector('.close-modal');
            closeBtn.onclick = () => {
                modal.style.display = 'none';
                document.body.removeChild(modal);
            };

            // Close on outside click
            modal.onclick = (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                    document.body.removeChild(modal);
                }
            };
        }

        // Function to get vaccine details
        function getVaccineDetails(vaccineName) {
            const vaccineDatabase = {
                'Yellow Fever': {
                    administration: 'Single subcutaneous injection',
                    dosage: '0.5 mL',
                    schedule: 'Single dose provides lifelong protection',
                    precautions: [
                        'Pregnancy - generally contraindicated',
                        'Immunosuppression',
                        'Age under 6 months',
                        'Severe egg allergy',
                        'HIV with low CD4 counts'
                    ],
                    sideEffects: [
                        'Mild fever and headache (common)',
                        'Muscle aches',
                        'Site injection pain',
                        'Rare serious reactions within 30 minutes',
                        'Very rare neurological complications'
                    ],
                    recommendedAge: '9 months and older',
                    protectionDuration: 'Lifetime',
                    storage: '2-8°C, protected from light'
                },
                'Hepatitis A': {
                    administration: 'Intramuscular injection in deltoid',
                    dosage: '0.5 mL/1.0 mL (age dependent)',
                    schedule: 'Two doses: initial and booster at 6-12 months',
                    precautions: [
                        'Previous severe reaction',
                        'Acute moderate/severe illness',
                        'Pregnancy (assess risk/benefit)',
                        'Bleeding disorders'
                    ],
                    sideEffects: [
                        'Soreness at injection site',
                        'Mild fatigue',
                        'Headache',
                        'Low-grade fever',
                        'Temporary arm discomfort'
                    ],
                    recommendedAge: '1 year and older',
                    protectionDuration: '20+ years after full series',
                    storage: '2-8°C, do not freeze'
                },
                'Typhoid': {
                    administration: 'Intramuscular injection or oral capsules',
                    dosage: '0.5 mL (injectable) or 4 capsules (oral)',
                    schedule: 'Single injection or 4 oral doses alternate days',
                    precautions: [
                        'Acute febrile illness',
                        'Previous typhoid reaction',
                        'Severe gastric conditions (for oral)',
                        'Antibiotics use (for oral vaccine)'
                    ],
                    sideEffects: [
                        'Injection site tenderness',
                        'Low-grade fever',
                        'Headache',
                        'Nausea',
                        'Abdominal discomfort (oral vaccine)'
                    ],
                    recommendedAge: '2 years and older',
                    protectionDuration: '2-3 years',
                    storage: '2-8°C'
                },
                'Hepatitis B': {
                    administration: 'Intramuscular injection',
                    dosage: '0.5 mL/1.0 mL (age dependent)',
                    schedule: 'Three doses: 0, 1, 6 months',
                    precautions: [
                        'Severe allergic reaction to previous dose',
                        'Yeast sensitivity',
                        'Moderate/severe illness',
                        'Latex allergy (some preparations)'
                    ],
                    sideEffects: [
                        'Injection site pain',
                        'Fatigue',
                        'Low-grade fever',
                        'Headache',
                        'Muscle aches'
                    ],
                    recommendedAge: 'All ages',
                    protectionDuration: '20+ years to lifetime',
                    storage: '2-8°C, do not freeze'
                }
            };

            // If we have specific data for this vaccine, return it
            if (vaccineDatabase[vaccineName]) {
                return vaccineDatabase[vaccineName];
            }

            // For other vaccines, return a generic template with common information
            return {
                administration: 'As per healthcare provider guidelines',
                dosage: 'As prescribed by healthcare provider',
                schedule: 'According to medical guidance',
                precautions: [
                    'Previous allergic reactions to vaccine components',
                    'Current acute illness or fever',
                    'Compromised immune system',
                    'Pregnancy or planning pregnancy',
                    'Certain medical conditions'
                ],
                sideEffects: [
                    'Injection site reactions (pain, redness, swelling)',
                    'Mild fever',
                    'Fatigue',
                    'Headache',
                    'Muscle aches',
                    'Temporary discomfort'
                ],
                recommendedAge: 'As per current guidelines',
                protectionDuration: 'Varies based on vaccine type',
                storage: '2-8°C unless specified otherwise'
            };
        }

        // Quote Slideshow functionality
        function setupQuoteSlideshow() {
            const slides = document.querySelectorAll('.quote-slide');
            const nav = document.querySelector('.quote-nav');
            let currentSlide = 0;
            let slideInterval;

            // Create navigation dots
            slides.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = `quote-dot ${index === 0 ? 'active' : ''}`;
                dot.addEventListener('click', () => goToSlide(index));
                nav.appendChild(dot);
            });

            function goToSlide(index) {
                slides[currentSlide].classList.remove('active');
                document.querySelectorAll('.quote-dot')[currentSlide].classList.remove('active');
                currentSlide = index;
                slides[currentSlide].classList.add('active');
                document.querySelectorAll('.quote-dot')[currentSlide].classList.add('active');
            }

            function nextSlide() {
                const next = (currentSlide + 1) % slides.length;
                goToSlide(next);
            }

            function startSlideshow() {
                if (slideInterval) {
                    clearInterval(slideInterval);
                }
                slideInterval = setInterval(nextSlide, 5000);
            }

            // Start the slideshow
            startSlideshow();

            // Pause on hover
            const slideshow = document.querySelector('.quote-slideshow');
            slideshow.addEventListener('mouseenter', () => clearInterval(slideInterval));
            slideshow.addEventListener('mouseleave', startSlideshow);
        }

        // Initialize quote slideshow after DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            setupQuoteSlideshow();
        });

        // ADD the function here
        function enterWebsite() {
            const welcomePage = document.getElementById('welcomePage');
            const transitionText = document.createElement('div');
            transitionText.className = 'transition-text';
            transitionText.textContent = 'Welcome to TravelVax';
            document.body.appendChild(transitionText);

            // Reduce delay and add smooth animation
            welcomePage.style.transition = 'transform 0.5s ease-out, opacity 0.5s ease-out';
            welcomePage.style.transform = 'translateY(-100%)';
            welcomePage.style.opacity = '0';

            setTimeout(() => {
                welcomePage.style.display = 'none';
                document.body.removeChild(transitionText);
            }, 500); // Reduced from 800ms to 500ms
        }

        // Add this to your existing JavaScript
        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const chatMessages = document.getElementById('chatMessages');
            const message = chatInput.value.trim();
            
            if (message) {
                // Add user message
                const userDiv = document.createElement('div');
                userDiv.style.cssText = 'padding: 0.8rem 1rem; border-radius: 10px; max-width: 80%; margin: 0.5rem 0; align-self: flex-end; background: linear-gradient(135deg, #4285f4, #34a853); color: white;';
                userDiv.textContent = message;
                chatMessages.appendChild(userDiv);
                
                // Clear input
                chatInput.value = '';
                
                // Get context for the AI response
                const selectedCountry = document.getElementById('country').value;
                const age = document.getElementById('age').value;
                const conditions = Array.from(document.querySelectorAll('input[name="conditions"]:checked'))
                    .map(checkbox => checkbox.value);
                
                // Generate AI response using Gemini
                const prompt = `As a medical travel expert, answer this question:
                "${message}"
                
                Context:
                - Destination: ${selectedCountry}
                - Traveler Age: ${age || 'Not specified'}
                - Medical Conditions: ${conditions.join(', ') || 'None specified'}
                
                Provide a clear, helpful response focusing on travel health aspects.`;
                
                // Call Gemini API
                callGeminiAPI(prompt).then(response => {
                    const botDiv = document.createElement('div');
                    botDiv.style.cssText = 'padding: 0.8rem 1rem; border-radius: 10px; max-width: 80%; margin: 0.5rem 0; align-self: flex-start; background: #f8f9fa; color: #333;';
                    botDiv.innerHTML = response || "I apologize, but I'm having trouble generating a response. Please try asking your question in a different way.";
                    chatMessages.appendChild(botDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }).catch(error => {
                    console.error('Chat error:', error);
                    const errorDiv = document.createElement('div');
                    errorDiv.style.cssText = 'padding: 0.8rem 1rem; border-radius: 10px; max-width: 80%; margin: 0.5rem 0; align-self: flex-start; background: #f8d7da; color: #721c24;';
                    errorDiv.textContent = "I apologize, but I'm having trouble connecting. Please try again later.";
                    chatMessages.appendChild(errorDiv);
                });
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        // Add Enter key support
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Function to add custom health condition
        function addCustomCondition() {
            const input = document.getElementById('newCondition');
            const condition = input.value.trim();
            
            if (condition) {
                const list = document.getElementById('customConditionsList');
                const tag = document.createElement('div');
                tag.className = 'custom-condition-tag';
                
                // Create hidden checkbox for the condition
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.name = 'conditions';
                checkbox.value = 'custom_' + condition.toLowerCase().replace(/\s+/g, '_');
                checkbox.checked = true;
                checkbox.style.display = 'none';
                
                tag.innerHTML = `
                    <div class="condition-name">${condition}</div>
                    <span class="remove-condition" onclick="removeCustomCondition(this)">×</span>
                `;
                
                tag.appendChild(checkbox);
                list.appendChild(tag);
                input.value = '';
                
                // Update selected conditions
                updateSelectedConditions();
            }
        }

        // Function to remove custom health condition
        function removeCustomCondition(element) {
            element.parentElement.remove();
        }

        // Enhance the fallback tips function
        function generateFallbackTips(countryData, age, conditions, vaccines) {
            const tips = [];
            
            // Add age-specific recommendations
            if (age) {
                if (age < 12) {
                    tips.push(`
                        <div class="tip-section">
                            <h4>Child-Specific Recommendations</h4>
                            <ul>
                                <li>Ensure all childhood vaccinations are up to date</li>
                                <li>Pack child-appropriate medications and first aid supplies</li>
                                <li>Consider shorter travel days to prevent fatigue</li>
                                <li>Bring familiar comfort items to reduce stress</li>
                            </ul>
                        </div>
                    `);
                } else if (age > 65) {
                    tips.push(`
                        <div class="tip-section">
                            <h4>Senior Travel Recommendations</h4>
                            <ul>
                                <li>Schedule regular rest periods during travel</li>
                                <li>Carry a detailed medical history</li>
                                <li>Consider travel insurance with medical evacuation coverage</li>
                                <li>Plan for adequate medication supplies</li>
                            </ul>
                        </div>
                    `);
                }
            }

            // Add condition-specific recommendations
            if (conditions && conditions.length > 0) {
                tips.push(`
                    <div class="tip-section">
                        <h4>Condition-Specific Advice</h4>
                        <ul>
                            ${conditions.map(condition => {
                                if (condition.startsWith('custom_')) {
                                    const conditionName = condition.replace('custom_', '').replace(/_/g, ' ');
                                    return `<li>For ${conditionName}, ensure you have:
                                        <ul>
                                            <li>Adequate medication supply</li>
                                            <li>Medical documentation</li>
                                            <li>Emergency contact information</li>
                                            <li>Healthcare provider's travel clearance</li>
                                        </ul>
                                    </li>`;
                                }
                                return getConditionSpecificAdvice(condition);
                            }).join('')}
                        </ul>
                    </div>
                `);
            }

            // Add destination-specific health information
            tips.push(`
                <div class="tip-section">
                    <h4>Local Health Information for ${countryData.name.common}</h4>
                    <ul>
                        <li>Region: ${countryData.region}</li>
                        <li>Required Vaccines: ${vaccines.filter(v => v.requirement === 'Required').map(v => v.name).join(', ') || 'None required'}</li>
                        <li>Recommended Vaccines: ${vaccines.filter(v => v.requirement === 'Recommended').map(v => v.name).join(', ') || 'None additional'}</li>
                        <li>Emergency Number: ${getEmergencyNumber(countryData.region)}</li>
                    </ul>
                </div>
            `);

            return `
                <div class="personalized-tips-container">
                    ${tips.join('')}
                    <div class="alert alert-warning">
                        <strong>Important:</strong> This is general travel health information. Please consult with your healthcare provider for personalized medical advice before traveling.
                    </div>
                </div>
            `;
        }

        // Helper function for condition-specific advice
        function getConditionSpecificAdvice(condition) {
            const adviceMap = {
                diabetes: `<li>For diabetes management:
                    <ul>
                        <li>Pack extra insulin and supplies</li>
                        <li>Carry a cooling case for medication</li>
                        <li>Bring glucose monitoring equipment</li>
                        <li>Pack snacks for low blood sugar</li>
                    </ul>
                </li>`,
                hypertension: `<li>For blood pressure management:
                    <ul>
                        <li>Pack blood pressure monitor</li>
                        <li>Maintain medication schedule across time zones</li>
                        <li>Monitor salt intake while traveling</li>
                        <li>Stay hydrated during flights</li>
                    </ul>
                </li>`,
                // Add more conditions as needed
            };
            
            return adviceMap[condition] || `<li>For ${condition}:
                <ul>
                    <li>Consult with your healthcare provider before travel</li>
                    <li>Carry necessary medications and documentation</li>
                    <li>Know local healthcare facilities</li>
                    <li>Have an emergency plan</li>
                </ul>
            </li>`;
        }

        // Helper function for emergency numbers
        function getEmergencyNumber(region) {
            const emergencyNumbers = {
                'Europe': '112',
                'Americas': '911',
                'Asia': 'Varies by country',
                'Africa': 'Varies by country',
                'Oceania': '000 (Australia) / 111 (New Zealand)'
            };
            
            return emergencyNumbers[region] || 'Check local emergency numbers';
        }

        // Add this after the existing checkbox labels
        document.querySelectorAll('.checkbox-label').forEach(label => {
            const checkbox = label.querySelector('input[type="checkbox"]');
            // Keep only the essential checkbox functionality
            if (checkbox) {
                checkbox.addEventListener('change', function() {
                    updateSelectedConditions();
                });
            }
        });

        // Update the custom condition addition function to remove description features
        function addCustomCondition() {
            const input = document.getElementById('newCondition');
            const condition = input.value.trim();
            
            if (condition) {
                const list = document.getElementById('customConditionsList');
                const tag = document.createElement('div');
                tag.className = 'custom-condition-tag';
                
                // Create hidden checkbox for the condition
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.name = 'conditions';
                checkbox.value = 'custom_' + condition.toLowerCase().replace(/\s+/g, '_');
                checkbox.checked = true;
                checkbox.style.display = 'none';
                
                tag.innerHTML = `
                    <div class="condition-name">${condition}</div>
                    <span class="remove-condition" onclick="removeCustomCondition(this)">×</span>
                `;
                
                tag.appendChild(checkbox);
                list.appendChild(tag);
                input.value = '';
                
                // Update selected conditions
                updateSelectedConditions();
            }
        }

        // Store condition descriptions
        const conditionDescriptions = new Map();

        function updateConditionDescription(condition, description) {
            if (description && description.trim()) {
                conditionDescriptions.set(condition, description.trim());
                // Add visual indicator that condition has description
                const label = document.querySelector(`[value="${condition}"]`).closest('.checkbox-label, .custom-condition-tag');
                label.classList.add('has-description');
            } else {
                conditionDescriptions.delete(condition);
                const label = document.querySelector(`[value="${condition}"]`).closest('.checkbox-label, .custom-condition-tag');
                label.classList.remove('has-description');
            }
        }

        // Update the generatePersonalizedTips function to include descriptions
        async function generatePersonalizedTips(countryData, age, conditions, vaccines) {
            if (!age && (!conditions || conditions.length === 0)) {
                return `<div class="alert alert-info">
                    Please provide your age and/or medical conditions for personalized health recommendations.
                </div>`;
            }

            try {
                // Get all conditions with their descriptions
                const conditionsWithDescriptions = conditions.map(condition => {
                    const description = conditionDescriptions.get(condition);
                    const displayName = condition.startsWith('custom_') ? 
                        condition.replace('custom_', '').replace(/_/g, ' ') : 
                        condition;
                    return {
                        name: displayName,
                        description: description || 'No additional details provided'
                    };
                });

                const prompt = `As a medical travel expert, provide detailed personalized health recommendations for a traveler:

                Destination: ${countryData.name.common}
                Region: ${countryData.region}
                Age: ${age || 'Not specified'}
                Medical Conditions and Details:
                ${conditionsWithDescriptions.map(c => `- ${c.name}: ${c.description}`).join('\n')}
                Required Vaccines: ${vaccines.map(v => v.name).join(', ')}

                Please provide comprehensive HTML-formatted advice including:

                1. Key Travel Health Recommendations:
                - Age-specific health concerns and precautions
                - Detailed management strategies for each medical condition
                - Required medical preparations and documentation
                - Specific vaccine considerations based on conditions

                2. Local Healthcare Information:
                - Nearest hospitals and clinics
                - Emergency numbers and procedures
                - Healthcare quality assessment
                - Insurance requirements and recommendations
                - Language considerations for medical care

                3. Climate & Environmental Impact:
                - Weather effects on medical conditions
                - Altitude considerations if relevant
                - Air quality and pollution levels
                - Local disease risks and prevention
                - Seasonal health considerations

                4. Medication & Treatment Planning:
                - Medication availability in destination
                - Local prescription requirements
                - Backup medication recommendations
                - Storage requirements in local climate
                - Emergency medication access

                5. Daily Health Management:
                - Condition-specific dietary advice
                - Physical activity modifications
                - Stress management techniques
                - Sleep and jet lag strategies
                - Monitoring and tracking recommendations

                6. Emergency Preparedness:
                - Condition-specific emergency plans
                - Local emergency response information
                - Medical evacuation options
                - Important phrases in local language
                - Emergency contact protocol

                Format the response in clear HTML with:
                - Bulleted lists for easy reading
                - Important warnings in bold
                - Clear section headings
                - Practical, actionable advice
                - Emergency information highlighted

                Return only the formatted HTML content.`;

                const response = await callGeminiAPI(prompt);
                
                if (response) {
                    return `
                        <div class="personalized-tips-container">
                            ${response}
                            <div class="alert alert-info mt-3">
                                <strong>Note:</strong> These recommendations are personalized based on your profile. Always consult with your healthcare provider before travel.
                            </div>
                        </div>
                    `;
                } else {
                    throw new Error('Failed to generate personalized recommendations');
                }
            } catch (error) {
                console.error('Error generating personalized tips:', error);
                return generateFallbackTips(countryData, age, conditions, vaccines);
            }
        }

        // Add this to your existing JavaScript
        let universalHealthDescription = '';

        document.addEventListener('DOMContentLoaded', function() {
            const universalHealthTextarea = document.getElementById('universalHealthInfo');
            const healthInfoPreview = document.getElementById('healthInfoPreview');

            if (universalHealthTextarea) {
                universalHealthTextarea.addEventListener('input', function(e) {
                    universalHealthDescription = e.target.value;
                    updateHealthInfoPreview();
                });
            }

            function updateHealthInfoPreview() {
                if (healthInfoPreview) {
                    if (universalHealthDescription.trim()) {
                        healthInfoPreview.style.display = 'block';
                        healthInfoPreview.innerHTML = `<strong>Your Health Summary:</strong><br>${universalHealthDescription}`;
                    } else {
                        healthInfoPreview.style.display = 'none';
                    }
                }
            }
        });
    </script>
</body>
</html>
